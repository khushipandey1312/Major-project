<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Heart Sound Classification</title>

    <link href="{{ url_for('static', filename='css/styles-merged.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='fonts/icomoon/style.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/predictor.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/back-to-top.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    

</head>


<body>

    <script src="{{ url_for('static', filename='//d3js.org/d3.v3.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/back-to-top') }}"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/recorderjs@0.0.1/recorder.js"></script>



<!-- Fixed navbar -->
<nav class="navbar navbar-default probootstrap-navbar">
    <div class="container">
        <div class="navbar-header">
            <button aria-controls="navbar" aria-expanded="false" class="navbar-toggle collapsed"
                    data-target="#navbar-collapse"
                    data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Heart Sound Classification</a>
        </div>

        <div class="navbar-collapse collapse" id="navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a data-nav-section="home" href="#">Home</a></li>
                <li><a data-nav-section="features" href="#">User Guide</a></li>
                <li><a data-nav-section="predict" href="#">Predict</a></li>
                <li><a data-nav-section="analysis" href="#">Analysis</a></li>
                <li><a data-nav-section="contact" href="#">Contact</a></li>
            </ul>
        </div>
    </div>
</nav>

<section class="probootstrap-hero probootstrap-slant"
         data-section="home" data-stellar-background-ratio="0.5" id="home">
    <div class="container">
        <div class="row intro-text">
            <div class="col-md-8 col-md-offset-2 text-center">
                <h1 class="probootstrap-heading probootstrap-animate" style="color:#E0F7FA">Predict your chance of
                    having a heart disease because prevention is better than cure!</h1>
                <div class="probootstrap-subheading center">
                    <p class="probootstrap-animate"><a class="btn btn-primary" href="#predict" role="button">Check
                        Now</a><a class="btn btn-default smoothscroll" href="#analysis" role="button">See Analysis</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<button class="btn btn-primary" id="backToTopBtn" onclick="topFunction()" title="Go to top">
    <span class="icon icon-align-top"></span>
</button>

<section class="probootstrap-section">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="probootstrap-service-item probootstrap-animate" data-animate-effect="fadeIn">
                    <span class="icon icon-phone3"></span>
                    <h2>Easy to Use</h2>
                    <p>Easier for anyone to predict the chance of getting heart disease.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="probootstrap-service-item probootstrap-animate" data-animate-effect="fadeIn">
                    <span class="icon icon-wallet2"></span>
                    <h2>Decrease Costs</h2>
                    <p>Examine your heart related reports by yourself. Predict the chance of having a heart disease free
                        of cost.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="probootstrap-service-item probootstrap-animate" data-animate-effect="fadeIn">
                    <span class="icon icon-lightbulb"></span>
                    <h2>Smart Idea</h2>
                    <p>Great accuracy. Accurate prediction rates. Analysis and prediction based on large samples of
                        data.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="probootstrap-section probootstrap-bg-light" data-section="features" id="features">
    <div class="container">
        <div class="row text-center mb100">
            <div class="col-md-8 col-md-offset-2 probootstrap-section-heading">
                <h2 class="mb30 text-black probootstrap-heading">User Guide</h2>
                <p></p>
            </div>
        </div>
        <!-- END row -->
        <div class="row mb100">
            <div class="col-md-8 probootstrap-animate">
                <img alt="GitHub Page" class="img-responsive probootstrap-shadow" src="{{ url_for('static', filename='img/body.jpg') }}">
            </div>
            <div class="col-md-4 probootstrap-section-heading">
                <h3 class="text-primary probootstrap-heading-2">Steps to be followed :</h3>
                <p>Go to the Predict Section of the website and record your heartbeat using the hardware part using your device's Record.</p>
                <ul class="probootstrap-list">
                    <li class="probootstrap-check">Place the chest piece at the apex part shown in figure 
                    </li>
                    <li class="probootstrap-check">Record your heartbeat for atleast 9 seconds </li>
                    <li class="probootstrap-check">Upload your audio file and click on predict</li>
                </ul>
            </div>
        </div>
    </div>
</section>
<!-- END section -->

<section class="probootstrap-section" data-section="predict" id="predict">
    <div class="container">
        <div class="row text-center mb100">
            <div class="col-md-8 col-md-offset-2 probootstrap-section-heading">
                <h2 class="mb30 text-black probootstrap-heading">Predict your Chance of Having a Heart Disease</h2>
                <p>Upload your audio file of heart beat . Get the chances of you contracting heart disease
                    based on the result</p>
            </div>
        </div>
        <!-- END row -->
        <!-- Main Div -->
        <!-- <div id="parent">
            <div id="wrapper">
                <div style="text-align: center;">
                    <h1 class="text-black probootstrap-heading">Heart Sound Classifier</h1>
                </div>
                <div class="form-container mt-4">
                    <form id="upload-form" action="/" method="POST" enctype="multipart/form-data" class="text-center">
                        <div class="mb-3">
                            <label for="file-upload" class="form-label">Upload a .wav file</label>
                            <input id="file-upload" type="file" name="file" accept=".wav" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Upload and Predict</button>
                    </form>
        
                    <div class="response mt-3 text-center">
                        {% if prediction %}
                            <div class="alert alert-success">Predicted Heart Condition: <strong>{{ prediction }}</strong></div>
                        {% endif %}
                        
                        {% if error %}
                            <div class="alert alert-danger"><strong>Error:</strong> {{ error }}</div>
                        {% endif %}
                    </div>
                </div>
                
            </div>
            <div class="clear"></div>
        </div> -->





        <div id="parent">
            <div id="wrapper">
                <div style="text-align: center;">
                    <h1 class="text-black probootstrap-heading">Heart Sound Classifier</h1>
                </div>
                
                <!-- Upload or Record Options -->
                <div class="form-container mt-4 text-center">
                    <form id="upload-form" action="/" method="POST" enctype="multipart/form-data">
                        <label for="file-upload" class="form-label">Upload Heartbeat Audio</label>
                        <input id="file-upload" type="file" name="file" accept=".wav" class="form-control mb-3" required>
        
                        <!-- Audio Recorder -->
                        <div class="mt-3">
                            <button type="button" id="record-btn" class="btn btn-warning">Record</button>
                            <button type="button" id="stop-btn" class="btn btn-danger" disabled>Stop</button>
                            <audio id="audio-player" controls style="display: none;"></audio>
                        </div>
        
                        <!-- Hidden Input to Store Recorded Audio -->
                        <input type="hidden" id="recorded-audio" name="recorded_audio">
                        
                        <!-- Buttons -->
                        <button type="submit" class="btn btn-success w-100 mt-3">Submit</button>
                        <button type="button" id="clear-btn" class="btn btn-secondary w-100 mt-2">Clear</button>
                    </form>
        
                    <div class="response mt-3 text-center">
                        {% if prediction %}
                            <div class="alert alert-success">Predicted Heart Condition: <strong>{{ prediction }}</strong></div>
                        {% endif %}
                        {% if error %}
                            <div class="alert alert-danger"><strong>Error:</strong> {{ error }}</div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</section>


<!-- END section -->

<section class="probootstrap-section" data-section="analysis" id="analysis" style="padding: 50px 0; background-color: #E5F1FB;">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-md-8 col-md-offset-2">
                <h2 class="mb-4 text-primary font-weight-bold">Analysis Results Based on the Prediction</h2>
                <p class="text-muted">Want to know what your heart sound says?</p>
            </div>
        </div>

        <!-- Row for Image & Content -->
        <div class="row d-flex align-items-center justify-content-center">
            <!-- Left Side: Image -->
            <div class="col-md-4 text-center">
                <img src="{{ url_for('static', filename='img/doctor.avif') }}" 
                     alt="Doctor" 
                     class="img-fluid rounded shadow-lg"
                     style="max-width: 350px; height: 570px;">
            </div>

            <!-- Right Side: Content with Border -->
            <div class="col-md-6">
                <div class="container-fluid p-4 border border-primary rounded shadow-lg" style="background: white;">
                    <div class="row row-cols-1 row-cols-md-2 g-4">
                        <!-- Murmur -->
                        <div class="col">
                            <div class="card border-danger shadow-sm h-100">
                                <div class="card-body text-center">
                                    <h4 class="card-title text-danger">Murmur</h4>
                                    <p class="card-text">
                                        Murmurs are abnormal heart sounds caused by turbulent blood flow. They may indicate underlying heart conditions such as valve disorders.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Normal -->
                        <div class="col">
                            <div class="card border-success shadow-sm h-100">
                                <div class="card-body text-center">
                                    <h4 class="card-title text-success">Normal</h4>
                                    <p class="card-text">
                                        A normal heart sound consists of two beats, "lub-dub," which correspond to the opening and closing of heart valves, indicating a healthy heart.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Extra Heart Sounds (Extrahls) -->
                        <div class="col">
                            <div class="card border-primary shadow-sm h-100">
                                <div class="card-body text-center">
                                    <h4 class="card-title text-primary">Extra Heart Sounds (Extrahls)</h4>
                                    <p class="card-text">
                                        Extra heart sounds like S3 and S4 may suggest heart failure, stiffness, or rapid filling of the ventricles. Some may be harmless, but others require medical attention.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Artifact Sounds -->
                        <div class="col">
                            <div class="card border-warning shadow-sm h-100">
                                <div class="card-body text-center">
                                    <h4 class="card-title text-warning">Extrastole Sounds</h4>
                                    <p class="card-text">
                                        Extrastole is an extra heartbeat that briefly interrupts your regular heart rhythm.Often Harmless but if you feel any discomfort see a doctor.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> <!-- End of Content Container -->
            </div> <!-- End of Right Side -->
        </div> <!-- End of Row -->
    </div>
</section>



<section class="probootstrap-section probootstrap-cta">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2 text-center" style= "max-height: 10px; padding-bottom: 50px;">
                <h2 class="probootstrap-heading">Contact Us</h2>
            </div>
        </div>
    </div>
</section>

<section class="probootstrap-section probootstrap-bg-light" data-section="contact">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <form action="" class="probootstrap-form">
                    <h2 class="text-black mt0">Get In Touch</h2>
                    <div class="form-group">
                        <input class="form-control" placeholder="Your Name" type="text">
                    </div>
                    <div class="form-group">
                        <input class="form-control" placeholder="Your Email" type="email">
                    </div>
                    <div class="form-group">
                        <input class="form-control" placeholder="Your Phone" type="number">
                    </div>
                    <div class="form-group">
                        <textarea class="form-control" cols="30" placeholder="Write a Message" rows="10"></textarea>
                    </div>
                    <div class="form-group">
                        <input class="btn btn-primary" type="submit" value="Send Message">
                    </div>
                </form>
            </div>
            <div class="col-md-3 col-md-push-1">
                <ul class="probootstrap-contact-details">
                    <li>
                        <span class="text-uppercase">Email <span class="icon icon-email"></span></span>
                        khushipandey1133@gmail.com <br>
                        varshabramhankar94@gmail.com
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

<footer class="probootstrap-footer">
    <div class="container text-center">
        <div class="row">
            <div class="col-md-12">
                <a class="probootstrap-link" href="#home"></span></a> <br>
                &copy; 2025. All Rights Reserved. <br> </a>
            </div>
        </div>
    </div>
</footer>


<!-- <script> 
    $(document).ready(function(){
        $('#upload-form').submit(function(e){
            e.preventDefault();  // Prevent full-page reload
    
            var formData = new FormData(this); // Store form data
    
            $.ajax({
                url: '/',  // Your backend Flask route
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                beforeSend: function() {
                    $('.response').html('<div class="alert alert-info">Processing...</div>'); // Show loading message
                },
                success: function(response) {
                    if (response.prediction) {
                        $('.response').html(
                            '<div class="alert alert-success">Predicted Heart Condition: <strong>' + response.prediction + '</strong></div>'
                        );
                    } else if (response.error) {
                        $('.response').html(
                            '<div class="alert alert-danger"><strong>Error:</strong> ' + response.error + '</div>'
                        );
                    }
                },
                error: function() {
                    $('.response').html('<div class="alert alert-danger">Something went wrong. Please try again.</div>');
                }
            });
        });
    });
    </script> -->
    <script src="https://cdn.jsdelivr.net/gh/mattdiamond/Recorderjs/recorder.js"></script>


    <!-- Gradio Mount Script -->
    <script>
        let mediaRecorder;
        let audioChunks = [];
    
        // üéôÔ∏è Start Recording
        $("#record-btn").click(function () {
            audioChunks = [];
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(function (stream) {
                    mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.ondataavailable = function (event) {
                        audioChunks.push(event.data);
                    };
                    mediaRecorder.start();
                    $("#record-btn").prop("disabled", true);
                    $("#stop-btn").prop("disabled", false);
                    $(".response").html('<div class="alert alert-info">Recording... Speak now!</div>'); // Indicate recording status
                })
                .catch(function (error) {
                    console.error("Error accessing microphone: ", error);
                    alert("Microphone access denied or unavailable.");
                });
        });
    
        // ‚èπÔ∏è Stop Recording and Show Audio Preview
        $("#stop-btn").click(function () {
            mediaRecorder.stop();
            mediaRecorder.onstop = function () {
                const audioBlob = new Blob(audioChunks, { type: "audio/wav" });
                const audioUrl = URL.createObjectURL(audioBlob);
    
                // üéß Set audio source and show audio player
                $("#audio-player").attr("src", audioUrl);
                $("#audio-player").show();
    
                // Prepare recorded audio as a file
                const recordedFile = new File([audioBlob], "recorded_audio.wav", {
                    type: "audio/wav",
                });
    
                // Set recorded file to file input so it can be submitted
                const dataTransfer = new DataTransfer();
                dataTransfer.items.add(recordedFile);
                document.getElementById("file-upload").files = dataTransfer.files;
    
                $("#record-btn").prop("disabled", false);
                $("#stop-btn").prop("disabled", true);
                $(".response").html('<div class="alert alert-success">Recording complete. Ready to submit!</div>');
            };
        });
    
        // üßπ Clear Form and Reset Player
        $("#clear-btn").click(function () {
            $("#file-upload").val(""); // Clear uploaded file
            $("#audio-player").hide(); // Hide audio preview
            $("#audio-player").attr("src", ""); // Reset audio source
            $("#record-btn").prop("disabled", false);
            $("#stop-btn").prop("disabled", true);
            $(".response").html(""); // Clear response
        });
    
        // üì§ Handle Form Submission
        $("#upload-form").submit(function (e) {
            e.preventDefault(); // Prevent page reload
    
            var formData = new FormData(this);
    
            // Check if a file or recorded audio is selected
            if ($("#file-upload")[0].files.length === 0) {
                alert("Please select a file or record an audio.");
                return;
            }
    
            $.ajax({
                url: "/",
                type: "POST",
                data: formData,
                contentType: false,
                processData: false,
                beforeSend: function () {
                    $(".response").html(
                        '<div class="alert alert-info">Processing...</div>'
                    );
                },
                success: function (response) {
                    if (response.prediction) {
                        $(".response").html(
                            '<div class="alert alert-success">Predicted Heart Condition: <strong>' +
                                response.prediction +
                                "</strong></div>"
                        );
                    } else if (response.error) {
                        $(".response").html(
                            '<div class="alert alert-danger"><strong>Error:</strong> ' +
                                response.error +
                                "</div>"
                        );
                    }
                },
                error: function () {
                    $(".response").html(
                        '<div class="alert alert-danger">Something went wrong. Please try again.</div>'
                    );
                },
            });
        });
    </script>
  
    
    
    
    
<script src="{{ url_for('static', filename='js/scripts.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/custom.js') }}"></script>

</body>
</html>
